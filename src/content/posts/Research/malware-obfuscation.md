---
title: Malware Obfuscation Techniques
published: 2025-02-20
description: ''
image: ''
tags: [Malware, MITRE ATT&CK, Evasion, Obfuscation]
category: 'Research'
draft: false 
lang: ''
---

<!-- markdownlint-disable MD013 -->

In modern computer era, various algorithms are used for confidentially, integrity and authentication of data. Similarly, the malware developers use obfuscation techniques to conceal the malicious code to bypass the malware detection system (Antivirus) [^1].

**Tactic**: Defense Evasion
**Technique**: Obfuscated Files or Information:

- T1027.007 Dynamic API Resolution
- T1027.008 Stripped Payloads

1. **Code Transposition**
Unconditional jump statements are inserted into the program code for changing the order of code execution without affecting the actual behaviour of malware program.
![image](https://hackmd.io/_uploads/r1DuCR7iJl.png)
The figure above shows an example about reordered code using unconditional jump instructions.  It seems very simple for this example to find out the original order but for hundred lines of code, it becomes cumbersome for the analyst to find out the actual order.
1. **Dead-Code Insertion**
Malware writers insert the dead code into the program for creating the new version of same malware just for increasing the overhead of the analyst [^2]. This approach can evade the signature-based detection systems. When the redundant code is inserted then the different signature is generated. Moreover, a serious of NOP (Not operation like instruction in x86) statements are inserted in the malware to create new variants.
![image](https://hackmd.io/_uploads/By7T114j1e.png)
1. **Instruction Substitution**
This obfuscation technique substitutes the originals instructions of malware with other instruction while retaining the semantic of malware [^2] [^3]. Thereby, numbers of variants of same malware files can be created. To handle this problem for every possible variant of same malware the unique signatures is required to detect these variants as well. It is not an impossible task but with the face of increasing new variants of same malware is not an easy task. For example, multiplication can be performed using either a series of `ADD` instructions instead a single `MUL` instruction. Another example is showed below:
![image](https://hackmd.io/_uploads/HJpOQyEikx.png)
1. **Register Reassignment**
In this obfuscation technique, the identifiers of constants, variables, and registers are changed with other names without altering the semantic. However, it is expensive obfuscation approach because it requires manual transformation of identifiers of constants, registers, and variables. Below is an example about renaming the registers:
![image](https://hackmd.io/_uploads/HJ5Xh7Ei1g.png)
1. **Dynamic API Resolution**
Malware authors often avoid directly referencing API function calls to evade static analysis and signature-based detection techniques. Instead of calling APIs using explicit function names, the malware dynamically resolves them at runtime. This technique prevents direct identification of suspicious API calls in a disassembled or decompiled view of the malware binary.

For this test, I used the free version of Obfuscator Executive [^4] to obfuscate the sample. The results are shown below:
![image](https://hackmd.io/_uploads/SJ3cwqgikl.png)
Obfuscator Executive works by obscuring critical components within executables and binary files, such as class names, functions, subroutines, objects, variables, constants, and UI elements. It replaces meaningful identifiers with indistinguishable placeholders, making it harder for attackers to understand and reverse engineer your software.
Before obscuring:
![image](https://hackmd.io/_uploads/S1GONVHskl.png)
After obscuring:
![image](https://hackmd.io/_uploads/Sk9F4EHjJl.png)

[^1]:  Singh, Jagsir, and Jaswinder Singh. "Challenge of malware analysis: malware obfuscation techniques." International Journal of Information Security Science 7.3 (2018): 100-110.
[^2]: R. Hedayat, The devil’s right hand: An investigation on malware-oriented obfuscation technique. Report, pp no:-31-67, 2016.
[^3]: I. You, K. Yim, “Malware Obfuscation Techniques: A Brief Survey”, International Conference on Broadband, Wireless Computing, Communication and Applications, pp no: 297-300, 2010.
[^4]: Executive, O. (2024, December 1). Obfuscator Executive – secure EXE and binary files. (C) Obfuscator Executive 2025. Retrieved March 1, 2025, from <https://obfuscator-executive.com/>
